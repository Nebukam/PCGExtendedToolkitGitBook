# v2

{% hint style="warning" %}
This page was generated from the source code. It captures what the node does, but still needs some serious  proofreading.
{% endhint %}

> Relaxes cluster points using axis-aligned bounding boxes to prevent overlap.

#### How It Works

This node adjusts the positions of points within clusters to ensure their bounding boxes don't overlap. It calculates the space each point occupies and checks for collisions with other points in the same cluster. When overlaps are found, it applies forces that push the points apart based on a chosen separation method.

The process starts by defining how large each point's bounding box should be â€” either using a fixed size or reading sizes from an attribute. Then, for every pair of points, it checks if their boxes intersect. If they do, the node calculates how to separate them using one of three methods: minimum penetration (pushing along the smallest overlap), edge direction (using connections between points), or centroid (pushing directly away from each other's center).

Each iteration applies repulsion forces proportional to the amount of overlap and a strength setting. This continues until all overlaps are resolved or a maximum number of iterations is reached.

#### Configuration

<details>

<summary><strong>Extents Input</strong><br><em>How extents are determined.</em></summary>

Controls whether the box extents are defined by a constant value or read from an attribute.

**Values**:

* **Constant**: Use the value specified in the **Extents** setting.
* **Attribute**: Read extents from the input data using the **Extents (Attr)** attribute.

</details>

<details>

<summary><strong>Extents (Attr)</strong><br><em>Attribute to read extents value from.</em></summary>

The attribute used when **Extents Input** is set to "Attribute". Expected to be half-size in each axis.

</details>

<details>

<summary><strong>Extents</strong><br><em>Constant extents value. Half-size in each axis.</em></summary>

The box half-size in each axis (X, Y, Z) when **Extents Input** is set to "Constant".

</details>

<details>

<summary><strong>Separation Mode</strong><br><em>How to determine separation direction when boxes overlap.</em></summary>

Determines how the direction of separation force is calculated when overlapping occurs.

**Values**:

* **Minimum Penetration**: Separates along the axis with minimum overlap.
* **Edge Direction**: Separates along connected edge directions if nodes are connected; otherwise, falls back to minimum penetration.
* **Centroid**: Separates directly away from each other's centers.

</details>

<details>

<summary><strong>Padding</strong><br><em>Additional padding between boxes.</em></summary>

Adds extra space around each box to ensure a minimum distance between objects, even when they are not overlapping.

</details>

<details>

<summary><strong>Use Oriented Bounds</strong><br><em>Whether to consider rotation when computing bounds.</em></summary>

When enabled, considers the rotation of points when calculating bounding boxes. This is more computationally expensive but can provide better results for rotated objects.

</details>

#### Usage Example

Place a cluster of buildings or trees using this node to ensure they don't overlap. Set **Extents Input** to "Attribute" and use an attribute like `BuildingSize` to define the half-size of each building. Choose **Edge Direction** separation mode if you want buildings to be pushed apart along their connecting edges (e.g., for roads or paths). Add padding to ensure a minimum gap between structures.

#### Notes

* This node works best with clusters that have a defined graph structure for edge-based separation.
* Increasing the **Repulsion Constant** makes the relaxation more aggressive, but may cause instability in convergence.
* For large clusters, performance can be improved by reducing the number of iterations or using simpler separation modes.
